# .github/workflows/cleanup.yml
name: üßπ D·ªçn D·∫πp L·ªãch S·ª≠ Ch·∫°y C·ªßa Workflow

on:
  schedule:
    # Cron Job: Ch·∫°y m·ªói tu·∫ßn m·ªôt l·∫ßn v√†o Th·ª© Hai l√∫c 01:00 AM UTC
    # (T∆∞∆°ng ƒë∆∞∆°ng 8:00 AM gi·ªù Vi·ªát Nam)
    - cron: '0 1 * * 1'
  workflow_dispatch: # Cho ph√©p ch·∫°y th·ªß c√¥ng khi c·∫ßn

jobs:
  delete_runs:
    runs-on: ubuntu-latest
    
    # R·∫§T QUAN TR·ªåNG: C·∫ßn quy·ªÅn ghi (write) cho Actions ƒë·ªÉ x√≥a l·ªãch s·ª≠ ch·∫°y
    permissions:
      actions: write
      contents: read

    steps:
      - name: üóëÔ∏è X√≥a L·ªãch S·ª≠ Ch·∫°y c·ªßa Workflow Ch√≠nh
        # S·ª¨ D·ª§NG ACTION ƒê√É ƒê∆Ø·ª¢C X√ÅC MINH V√Ä KH·∫ÆC PH·ª§C L·ªñI KH√îNG T√åM TH·∫§Y REPO
        uses: peter-murray/workflow-run-cleanup-action@v2
        with:
          # Token c·∫ßn thi·∫øt ƒë·ªÉ c·∫•p quy·ªÅn x√≥a (L∆∞u √Ω: tham s·ªë l√† github_token)
          github_token: ${{ secrets.GITHUB_TOKEN }}
          
          # Ch·ªâ gi·ªØ l·∫°i l·ªãch s·ª≠ ch·∫°y trong 7 ng√†y g·∫ßn nh·∫•t (X√≥a nh·ªØng c√°i c≈© h∆°n)
          retain_days: 7
          
          # T√™n ch√≠nh x√°c c·ªßa Workflow m√† b·∫°n mu·ªën x√≥a l·ªãch s·ª≠ ch·∫°y
          workflow: 'Podcast Generator - Full Pipeline (Final Fix)'
          
          # Ch·ªâ x√≥a c√°c l·∫ßn ch·∫°y ƒë√£ ho√†n th√†nh (kh√¥ng x√≥a c√°c l·∫ßn ƒëang ch·∫°y)
          status: completed
