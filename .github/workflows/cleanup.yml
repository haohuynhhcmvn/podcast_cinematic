# .github/workflows/cleanup.yml
name: üßπ D·ªçn D·∫πp L·ªãch S·ª≠ Ch·∫°y C·ªßa Workflow

on:
  schedule:
    # Cron Job: Ch·∫°y m·ªói tu·∫ßn m·ªôt l·∫ßn v√†o Th·ª© Hai l√∫c 01:00 AM UTC
    # (T∆∞∆°ng ƒë∆∞∆°ng 8:00 AM gi·ªù Vi·ªát Nam)
    - cron: '0 1 * * 1'
  workflow_dispatch: # Cho ph√©p ch·∫°y th·ªß c√¥ng khi c·∫ßn

jobs:
  delete_runs:
    runs-on: ubuntu-latest
    
    # R·∫§T QUAN TR·ªåNG: C·∫ßn quy·ªÅn ghi (write) cho Actions ƒë·ªÉ x√≥a l·ªãch s·ª≠ ch·∫°y
    permissions:
      actions: write
      contents: read

    steps:
      - name: üóëÔ∏è X√≥a L·ªãch S·ª≠ Ch·∫°y c·ªßa Workflow Ch√≠nh (Gi·∫£i ph√°p thay th·∫ø)
        # S·ª≠ d·ª•ng Action kh√°c ƒë·ªÉ ƒë·∫£m b·∫£o ho·∫°t ƒë·ªông
        uses: kolga/delete-workflow-runs-action@v1
        with:
          # Token c·∫ßn thi·∫øt ƒë·ªÉ c·∫•p quy·ªÅn x√≥a
          github_token: ${{ secrets.GITHUB_TOKEN }} 
          
          # T√™n ch√≠nh x√°c c·ªßa Workflow (S·ª≠ d·ª•ng ID ho·∫∑c t√™n)
          workflow_name: 'Podcast Generator - Full Pipeline (Final Fix)'
          
          # Ch·ªâ gi·ªØ l·∫°i l·ªãch s·ª≠ ch·∫°y trong 7 ng√†y g·∫ßn nh·∫•t (X√≥a nh·ªØng c√°i c≈© h∆°n)
          skip_runs_younger_than_days: 7
          
          # Ch·ªâ x√≥a c√°c l·∫ßn ch·∫°y ƒë√£ ho√†n th√†nh
          status: completed
